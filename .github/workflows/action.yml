name: update another repo

on: [push]

jobs:
    update-argo-repo:
        runs-on: ubuntu-latest
        name: update argo repo

        steps:
        


        - name: Checkout Project B
          uses: actions/checkout@v3
          with: 
            repository: shyamayadav154/argo
            token: ${{ secrets.TOKEN }}
            path: ./argo
            ref: main
            persist-credentials: true

        - name: Docker meta
          uses: docker/metadata-action@v4
          id: meta
          with:
            images: shyamayadav154/mevfinal
            tags: |
              type=sha

        - name: Push Project argo
          run: |
            echo $GITHUB_SHA
            cd ./argo
            cd k8
            sed -i "s|image: .*|image: ${{steps.meta.outputs.tags}}|g" frontend.yml
            git status
            git add ..
            git config user.name github-actions
            git config user.email github-actions@github.com
            git commit -am "File Replicated from Project A"
            git push